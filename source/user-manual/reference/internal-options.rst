.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
  :description: In this section of the Wazuh documentation, you will find all the information related to the internal configuration of Wazuh.

.. _reference_internal_options:

Internal configuration
=======================

The main configuration is located in the ``ossec.conf`` file, however some internal configuration features are located in the ``/var/ossec/etc/internal_options.conf`` file.

Generally, this file is reserved for debugging issues and for troubleshooting. **Any error in this file may cause your installation to malfunction or fail to run.**

.. warning::
    This file will be overwritten during upgrades.  In order to maintain custom changes, you must use the ``/var/ossec/etc/local_internal_options.conf`` file.

- `Agent`_
- `Authd`_
- `DBD`_
- `Execd`_
- `Integrator`_
- `Logcollector`_
- `Maild`_
- `Monitord`_
- `Remoted`_
- `Syscheck`_
- `Rootcheck`_
- `Security Configuration Assessment`_
- `Wazuh`_
- `Wazuh Clusterd`_
- `Wazuh Database`_
- `Wazuh Modules`_
- `Wazuh Command`_
- `Wazuh-download`_
- `Windows`_


Agent
-----

+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.tolerance**       | Description    | Number of seconds the agent is full before triggering a flooding alert.          |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 15                                                                               |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | Any integer between 0 and 600.                                                   |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.warn_level**      | Description    | Percentage of occupied capacity in agent buffer to trigger a warning alert.      |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 90                                                                               |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | Any integer between 1 and 100.                                                   |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.normal_level**    | Description    | Percentage of occupied capacity in agent buffer to return to normal state.       |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 70                                                                               |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | Any integer between 0 and *agent.warn_level - 1*.                                |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.min_eps**         | Description    | Minimum events per second permitted in ``<client_buffer>`` configuration.        |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 50                                                                               |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | Any integer between 1 and 1000.                                                  |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.recv_timeout**    | Description    | Maximum number of seconds to wait for server response from the TCP client socket.|
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 60                                                                               |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | Any integer between 1 and 600.                                                   |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.state_interval**  | Description    | The interval between the updates of the agent status file in seconds.            |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 5                                                                                |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed values | 0: Disable status file                                                           |
+                           +                +----------------------------------------------------------------------------------+
|                           |                | Any other integer between 1 and 86400                                            |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.debug**           | Description    | Run the Unix agent processes in debug mode.                                      |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 0                                                                                |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | 0: No debug output.                                                              |
+                           +                +----------------------------------------------------------------------------------+
|                           |                | 1: Standard debug output.                                                        |
+                           +                +----------------------------------------------------------------------------------+
|                           |                | 2: Verbose debug output.                                                         |
+---------------------------+----------------+----------------------------------------------------------------------------------+
| **agent.remote_conf**     | Description    | Apply or refuse remote configuration.                                            |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Default value  | 1                                                                                |
+                           +----------------+----------------------------------------------------------------------------------+
|                           | Allowed value  | 0: Remote configuration is disabled.                                             |
+                           +                +----------------------------------------------------------------------------------+
|                           |                | 1: Remote configuration is enabled.                                              |
+---------------------------+----------------+----------------------------------------------------------------------------------+

Authd
-----

+-------------------------------+---------------+--------------------------------------------------------------------------+
|   **authd.debug**             | Description   | Debug level.                                                             |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Default value | 0                                                                        |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Allowed value | 0: No debug output                                                       |
+                               +               +--------------------------------------------------------------------------+
|                               |               | 1: Standard debug output                                                 |
+                               +               +--------------------------------------------------------------------------+
|                               |               | 2: Verbose debug output                                                  |
+-------------------------------+---------------+--------------------------------------------------------------------------+
| **auth.timeout_seconds**      | Description   | Network timeout to automatically close connections (second part).        |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Default value | 1                                                                        |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Allowed value | Any integer between 1 and 2147483647.                                    |
+-------------------------------+---------------+--------------------------------------------------------------------------+
| **auth.timeout_microseconds** | Description   | Network timeout to automatically close connections (microsecond part).   |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Default value | 0                                                                        |
+                               +---------------+--------------------------------------------------------------------------+
|                               | Allowed value | Any integer between 0 and 999999.                                        |
+-------------------------------+---------------+--------------------------------------------------------------------------+

.. _ossec_internal_syscheck:

Syscheck
--------

+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.rt_delay**                | Description   | Time in milliseconds for delay between alerts in real-time.                    |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 10                                                                             |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | Any integer between 1 and 1000                                                 |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.max_fd_win_rt**           | Description   | Maximum numbers of directories can be configured in ossec.conf for Windows     |
|                                      |               | in realtime and whodata mode.                                                  |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 256                                                                            |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | Any integer between 1 and 1024                                                 |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.max_audit_entries**       | Description   | Maximum number of directories monitored for who-data on Linux.                 |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 256                                                                            |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | Any integer between 1 and 4096                                                 |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.default_max_depth**       | Description   | Maximum level of recursion allowed while reading directories.                  |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 256                                                                            |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | Any integer between 1 and 320                                                  |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.symlink_scan_interval**   | Description   | Check interval of the symbolic links configured in the directories section.    |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 600                                                                            |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | Any integer between 1 and 2592000                                              |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
| **syscheck.file_max_size**           | Description   | Maximum file size for calculating integrity hashes (in mebibytes).             |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 1024                                                                           |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | 0: Unlimited                                                                   |
+                                      +               +--------------------------------------------------------------------------------+
|                                      |               | Any integer between 0 and 4095                                                 |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+
|    **syscheck.debug**                | Description   | Debug level (used in manager and Unix agent installations).                    |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Default value | 0                                                                              |
+                                      +---------------+--------------------------------------------------------------------------------+
|                                      | Allowed value | 0: No debug output                                                             |
+                                      +               +--------------------------------------------------------------------------------+
|                                      |               | 1: Standard debug output                                                       |
+                                      +               +--------------------------------------------------------------------------------+
|                                      |               | 2: Verbose debug output                                                        |
+--------------------------------------+---------------+--------------------------------------------------------------------------------+

Rootcheck
---------

+--------------------------+----------------+-------------------------------------------------------------------------------+
|    **rootcheck.sleep**   | Description    | Number of milliseconds to sleep after reading one PID or suspicious port.     |
+                          +----------------+-------------------------------------------------------------------------------+
|                          | Default value  | 50                                                                            |
+                          +----------------+-------------------------------------------------------------------------------+
|                          | Allowed values | Any integer between 0 and 1000.                                               |
+--------------------------+----------------+-------------------------------------------------------------------------------+

Security Configuration Assessment
---------------------------------

+-----------------------------------+----------------+------------------------------------------------------------------------------------------------------------------+
|    **sca.request_db_interval**    | Description    | In case of integrity fail, this is the maximum interval (minutes) to resend the scan information to the manager. |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Default value  | 5                                                                                                                |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Allowed values | Any integer between 1 and 60.                                                                                    |
+-----------------------------------+----------------+------------------------------------------------------------------------------------------------------------------+
|    **sca.remote_commands**        | Description    | Enable the execution of commands in policy files received from the manager (Files in etc/shared).                |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Default value  | 0                                                                                                                |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Allowed values | 1 (enabled) or 0 (disabled).                                                                                     |
+-----------------------------------+----------------+------------------------------------------------------------------------------------------------------------------+
|    **sca.commands_timeout**       | Description    | Timeout for the commands execution.                                                                              |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Default value  | 30 (seconds)                                                                                                     |
+                                   +----------------+------------------------------------------------------------------------------------------------------------------+
|                                   | Allowed values | Any integer between 1 and 300.                                                                                   |
+-----------------------------------+----------------+------------------------------------------------------------------------------------------------------------------+

Vulnerability Detection
-----------------------

+----------------------------------------------------+----------------+----------------------------------------------------------------------------------+
|  **vulnerability-detection.translation_lru_size**  | Description    | LRU cache size assigned for package translation process (in number of elements). |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Default value  | 2048                                                                             |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Allowed values | Any integer between 1 and 100000                                                 |
+----------------------------------------------------+----------------+----------------------------------------------------------------------------------+
|  **vulnerability-detection.osdata_lru_size**       | Description    | LRU cache size assigned for agents' OS data (in number of elements).             |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Default value  | 1000                                                                             |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Allowed values | Any integer between 1 and 100000                                                 |
+----------------------------------------------------+----------------+----------------------------------------------------------------------------------+
|  **vulnerability-detection.remediation_lru_size**  | Description    | LRU cache size assigned for vulnerability remediation (in number of elements).   |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Default value  | 2048                                                                             |
+                                                    +----------------+----------------------------------------------------------------------------------+
|                                                    | Allowed values | Any integer between 1 and 100000                                                 |
+----------------------------------------------------+----------------+----------------------------------------------------------------------------------+

Wazuh
-----

+-------------------------------+----------------+--------------------------------------------------------------------+
|  **wazuh.thread_stack_size**  | Description    | Stack size assigned for child threads created in Wazuh (in KiB).   |
+                               +----------------+--------------------------------------------------------------------+
|                               | Default value  | 8192                                                               |
+                               +----------------+--------------------------------------------------------------------+
|                               | Allowed values | Any integer between 2048 and 65536                                 |
+-------------------------------+----------------+--------------------------------------------------------------------+

Wazuh Clusterd
--------------

+---------------------------+----------------+------------------------------------------------------------------------+
| **wazuh_clusterd.debug**  | Description    | Debug level.                                                           |
+                           +----------------+------------------------------------------------------------------------+
|                           | Default value  | 0                                                                      |
+                           +----------------+------------------------------------------------------------------------+
|                           | Allowed value  | 0: No debug output.                                                    |
+                           +                +------------------------------------------------------------------------+
|                           |                | 1: Standard debug output.                                              |
+                           +                +------------------------------------------------------------------------+
|                           |                | 2: Verbose debug output.                                               |
+---------------------------+----------------+------------------------------------------------------------------------+

Wazuh Database
--------------

The Wazuh Database Synchronization Module starts automatically on the server and local profiles and requires no configuration, however, some optional settings are available.

The module uses *inotify* from Linux to monitor changes to every log file in real-time. Databases will be updated as soon as possible when a change is detected. **If inotify is not supported**, (for example, on operating systems other than Linux) every log file will be scanned continuously, looking for changes, with a default delay of one minute between scans.

How to disable the module
^^^^^^^^^^^^^^^^^^^^^^^^^

To disable the Wazuh Database Synchronization Module, the sync directives must be set to 0 in the ``etc/local_internal_options.conf`` file as shown below::

    wazuh_database.sync_agents=0

Once these settings have been adjusted, the file must be saved followed by a restart of Wazuh.  With the above settings, the Database Synchronization Module will not be loaded when Wazuh starts.

+-----------------------------------------------+---------------+-------------------------------------------------------------------------------------+
|   **wazuh_database.sync_agents**              | Description   | Toggles synchronization of agent database with client.keys on or off.               |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Default value | 1                                                                                   |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Allowed value | 0, 1                                                                                |
+-----------------------------------------------+---------------+-------------------------------------------------------------------------------------+
|    **wazuh_database.real_time**               | Description   | Toggles synchronization of data in real-time (supported on Linux only) on and off.  |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Default value | 1                                                                                   |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Allowed value | 0, 1                                                                                |
+-----------------------------------------------+---------------+-------------------------------------------------------------------------------------+
|      **wazuh_database.interval**              | Description   | Interval to sleep between cycles. (Only used if real time sync is disabled).        |
+                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Default value | 60                                                                                  |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Allowed value | Any integer between 0 and 86400 (seconds).                                          |
+-----------------------------------------------+---------------+-------------------------------------------------------------------------------------+
|      **wazuh_database.max_queued_events**     | Description   | Maximum number of queued events (only used if *inotify* is available).              |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Default value | 0 (use system default value).                                                       |
|                                               +---------------+-------------------------------------------------------------------------------------+
|                                               | Allowed value | Any integer between 0 and 2147483647.                                               |
+-----------------------------------------------+---------------+-------------------------------------------------------------------------------------+

.. _wazuh_modules_options:

Wazuh Modules
-------------

+--------------------------------+---------------+-------------------------------------------------------------------------------------+
| **wazuh_modules.task_nice**    | Description   | Indicates the priority of the tasks. The lower the value, the higher the priority.  |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Default value | 10                                                                                  |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Allowed value | Any integer between -20 and 19.                                                     |
+--------------------------------+---------------+-------------------------------------------------------------------------------------+
| **wazuh_modules.max_eps**      | Description   | Maximum number of events per second sent by all Wazuh Module.                       |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Default value | 100                                                                                 |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Allowed value | Any integer between 1 and 1000                                                      |
+--------------------------------+---------------+-------------------------------------------------------------------------------------+
| **wazuh_modules.kill_timeout** | Description   | Time for a process to quit before being killed during Modulesd exiting, in seconds. |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Default value | 10                                                                                  |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Allowed value | 0: Kill immediately                                                                 |
+                                +               +-------------------------------------------------------------------------------------+
|                                |               | Any integer between 1 and 3600                                                      |
+--------------------------------+---------------+-------------------------------------------------------------------------------------+
|   **wazuh_modules.debug**      | Description   | Debug level.                                                                        |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Default value | 0                                                                                   |
+                                +---------------+-------------------------------------------------------------------------------------+
|                                | Allowed value | 0: No debug output.                                                                 |
+                                +               +-------------------------------------------------------------------------------------+
|                                |               | 1: Standard debug output.                                                           |
+                                +               +-------------------------------------------------------------------------------------+
|                                |               | 2: Verbose debug output.                                                            |
+--------------------------------+---------------+-------------------------------------------------------------------------------------+

.. _wazuh_command_remote_commands:

Wazuh Command
-------------

+-----------------------------------+---------------+---------------------------------------------------------------------------------------------------+
| **wazuh_command.remote_commands** | Description   | Toggles whether Command Module should accept commands defined in the shared configuration or not. |
+                                   +---------------+---------------------------------------------------------------------------------------------------+
|                                   | Default value | 0                                                                                                 |
+                                   +---------------+---------------------------------------------------------------------------------------------------+
|                                   | Allowed value | 0: Disable remote commands.                                                                       |
+                                   +               +---------------------------------------------------------------------------------------------------+
|                                   |               | 1: Enable remote commands.                                                                        |
+-----------------------------------+---------------+---------------------------------------------------------------------------------------------------+

Wazuh-download
--------------

+------------------------------------+---------------+-------------------------------------------------------------------------------------+
|      **wazuh_download.enabled**    | Description   | Enable download module                                                              |
|                                    +---------------+-------------------------------------------------------------------------------------+
|                                    | Default value | 1                                                                                   |
+                                    +---------------+-------------------------------------------------------------------------------------+
|                                    | Allowed value | 0: Disable download module.                                                         |
+                                    +               +-------------------------------------------------------------------------------------+
|                                    |               | 1: Enable download module.                                                          |
+------------------------------------+---------------+-------------------------------------------------------------------------------------+

Windows
-------

+----------------------------+---------------+--------------------------------------------------------------------------+
|      **windows.debug**     | Description   | Debug level (used in windows agent installations).                       |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Default value | 0                                                                        |
+                            +---------------+--------------------------------------------------------------------------+
|                            | Allowed value | 0: No debug output.                                                      |
+                            +               +--------------------------------------------------------------------------+
|                            |               | 1: Standard debug output.                                                |
+                            +               +--------------------------------------------------------------------------+
|                            |               | 2: Verbose debug output.                                                 |
+----------------------------+---------------+--------------------------------------------------------------------------+
